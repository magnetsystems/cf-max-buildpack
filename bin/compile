#!/bin/bash
#
# Instead of compilation, unzip the single zip file and configure
# the deployment variables.

echo "Switching to directory $1"
cd $1
echo `pwd`
ls

# buildpack automatically appends .zip suffix
echo "Unzip max-server.zip"
unzip max-server

if [[ -z "$JAVA_HOME" ]]; then
  export JAVA_HOME=/home/vcap/app/.java-buildpack/open_jdk_jre
  export PATH=$JAVA_HOME/bin:$PATH
fi

echo "JAVA_HOME=$JAVA_HOME"
echo "PATH=$PATH"
echo "java in `which java`"


# This step will not be needed if the customization is done before the cf push.
echo "Set deployment environment"
max-server/bin/replace-env.sh max-server/server/conf/default deploy_env/default.props deploy_env/cf.props
